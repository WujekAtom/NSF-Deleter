<?xml version='1.0' encoding='utf-8'?>
<<<<<<< HEAD
<agent name='ImportAllVerseUsers' xmlns='http://www.lotus.com/dxl' version='9.0'
 maintenanceversion='1.10' replicaid='C125831D007B6F4A' hide='v3' publicaccess='false'
 designerversion='8.5.3' restrictions='unrestricted'>
<noteinfo noteid='3e6' unid='F8DE3DC52EEFEB91C125820A00442C14' sequence='7'>
<created><datetime>20180103T132437,32+01</datetime></created>
<modified><datetime dst='true'>20181006T002835,34+02</datetime></modified>
<revised><datetime>20180103T134433,70+01</datetime></revised>
<lastaccessed><datetime dst='true'>20181006T002835,33+02</datetime></lastaccessed>
<addedtofile><datetime dst='true'>20181006T002835,33+02</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Tomasz Wieszczura/OU=Poland/O=IBM</name></updatedby>
<wassignedby><name>CN=Tomasz Wieszczura/OU=Poland/O=IBM</name></wassignedby>
<designchange><datetime>20180103T134442,69+01</datetime></designchange>
<trigger type='actionsmenu'/>
<documentset type='runonce'/><code event='action'><javaproject class='JavaAgent.class'
 codepath='c:\Notes\Data'><java name='JavaAgent.java'>import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowEvent;

import lotus.domino.*;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;



public class JavaAgent extends AgentBase {

	//public ThreadLocal sessThread = new ThreadLocal();
   
	public void NotesMain() {

      try {

          Session session = getSession();
          AgentContext agentContext = session.getAgentContext();

          // (Your code goes here)
          
          int dialogResult = JOptionPane.showConfirmDialog(null, "You are going to import ALL users from  DominoDirectory. Are you sure?");
          if(dialogResult == JOptionPane.YES_OPTION){
            // Saving code here
        	  searchInNAB();
          }
          

      }
      catch(NotesException ne)
      {
    	  ne.printStackTrace();
      }
      catch(Exception e) {
          e.printStackTrace();
       }
     
   }
    

    public void createRequest(Document personDoc) throws NotesException
    {
    	Session s = getSession();
    	AgentContext agt = s.getAgentContext();
    	Database dbCurr = agt.getCurrentDatabase();
    	String srv = dbCurr.getServer();	//Server name where this app is
    	
    	Document doc = dbCurr.createDocument();
    	
    	//Mapping fields from PersonDoc to Request
    	
    	doc.appendItemValue("Form", "Request");
    	doc.appendItemValue("reqStatus", "Queue");
    	
    	doc.appendItemValue("reqDep", personDoc.getItemValueString("OfficeCountry"));
    	doc.appendItemValue("reqEGID", personDoc.getItemValueString("EmployeeID"));
    	doc.appendItemValue("reqFullName", personDoc.getItemValueString("FullName"));
    	doc.appendItemValue("reqMailServer", personDoc.getItemValueString("MailServer"));
    	
    	doc.appendItemValue("reqMail01", "");
    	doc.appendItemValue("reqMail02", "");
    	doc.appendItemValue("reqProcess", "");    	
    	
    	doc.computeWithForm(false, false);
    	
    	if (!doc.save())
    		System.out.println("CAN'T SAVE: " + personDoc.getItemValueString("EmployeeID"));
    	else
    		System.out.println("SAVED: " + personDoc.getItemValueString("EmployeeID"));

    }
    
    public void searchInNAB() throws NotesException
    {
    	
    	Session s = getSession();
    	AgentContext agt = s.getAgentContext();
    	Database dbCurr = agt.getCurrentDatabase();
    	String srv = dbCurr.getServer();	//Server name where this app is
    	View requestsView = dbCurr.getView("RequestQueue");
    	
    	System.out.println(srv);
    	
    	Document doc = null;
    	Document docTmp = null;
    	Database dbNAB = s.getDatabase(srv, "names.nsf");
    	System.out.println(dbNAB.getFileName());
    	View vPeople = dbNAB.getView("(PeopleByServer)");
    	
    	DocumentCollection dc = vPeople.getAllDocumentsByKey("MAIL");    	
    	System.out.println(dc.getCount());
    	
    	doc = dc.getFirstDocument();
    	
    	while (doc!=null)
    	{
    		createRequest(doc);
    		
    		docTmp = dc.getNextDocument(doc);
    		doc.recycle();
    		doc = docTmp;
    	}
    	System.out.println("END");
    }
    
   
}









</java></javaproject></code>
<rundata processeddocs='0' exitcode='0' agentdata='F7C9E1D82F51ACC9C125820A0046210E'>
<agentmodified><datetime>20180103T134433,72+01</datetime></agentmodified>
<agentrun><datetime>20180104T132706,33+01</datetime></agentrun>
<runlog>Started running agent 'ImportAllVerseUsers' on 2018-01-04 13:02:21
Ran Java Agent Class
Done running agent 'ImportAllVerseUsers' on 2018-01-04 13:27:06
</runlog></rundata>
<item name='$JavaCompilerSource'><text>1.3</text></item>
<item name='$JavaCompilerTarget'><text>1.2</text></item></agent>
=======
<note class='filter' xmlns='http://www.lotus.com/dxl' version='9.0' maintenanceversion='1.10'
 replicaid='C12582CD003E2D74'>
<noteinfo noteid='3e6' unid='F8DE3DC52EEFEB91C125820A00442C14' sequence='7'>
<created><datetime>20180103T132437,32+01</datetime></created>
<modified><datetime dst='true'>20180717T131934,06+02</datetime></modified>
<revised><datetime>20180103T134433,70+01</datetime></revised>
<lastaccessed><datetime dst='true'>20180717T131934,05+02</datetime></lastaccessed>
<addedtofile><datetime dst='true'>20180717T131934,05+02</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Tomasz Wieszczura/OU=Poland/O=IBM</name></updatedby>
<wassignedby><name>CN=Tomasz Wieszczura/OU=Poland/O=IBM</name></wassignedby>
<item name='$FILE' summary='true' sign='true' seal='true'><object><file hosttype='msdos'
 compression='none' flags='sign' encoding='none' name='%%source%%.jar' size='1214'>
<created><datetime dst='true'>20170920T153132,15+02</datetime></created>
<modified><datetime>20180103T134442,48+01</datetime></modified><filedata>
UEsDBBQACAAIAJNtI0wAAAAAAAAAAAAAAAAOAAAASmF2YUFnZW50LmphdmHdVk2P2zYQPTtA/sPE
l8ptIDc9drEo/Fls6njd2Nggp4IrjW22lKiQlL1GsP+9Q0qUJVWOFznWPkgU33vzyZF4kkll4G92
YCE7mnAsVYxqwU4yNzevX/HW9kSmhvEUVcfeXMjjRSIeMDXhKDJcpjN7fwWz4Npgt50C9omnsTx6
qQolpMl1GMuEpzL8sb5j+U+hPvJ0F74f58bI9KZ7c65Yghf2FuwRxYW9+8x6vmLpJbLdukTe4JOZ
cxSx89n+s/xR8AgiwbSG94Qd7ShYIBymsQa3GjON8NWie8NhSdjsFbJ4ISMmQKPWxRpuIcVjfTMY
kCkAIG7JPEgew1Ia1B+oyMGgUAb3M+pUX9rfmsQpYGfEXm9hh6Z86MXLn3PWNg95D6y+uPX0kMh1
mFOoawyHEHyWuYJIxgg7iRr2qHBQx9TvOSUr5kzI3UfUubCmaiUK9V4eydSWq2TqUEGaC/EW+mQD
mLIWqDBgJJTlGi0WkGtUGrZKJgBT12RTrjAyUp1CGBGJ2h90rvC3fjMBfBs0fWk683m2/ut+tbm7
Xw6+1mku6jU7WE9c2DbiM6AHlD2mov1duhyNWzl/bibGr6rHETPRPnDlnj1F6JyhHqnyWTpCNsjB
TFE614ZF/2wUi7BmqqV3lsIBNGL5lkil4i7lwvtc786I2tfgR/ySozbBVEZ5Yg9FRmWRKS0HYPZK
HjU04yqEfERV43a3bK/Vra5JO9vToafMsEd7DuPHSa4UgYli4XZFBL9/ZqyNsgXV6kDgghU6P9QB
FcHoLBf3kNIkgqMtOsXFNbAsA65LGW/fJyGW0VmvSJTfO9suL8PhB9KyXmzt0Cl7euXTaNu+THKT
RzZCItIEujOYPDCRY9CfS5X06eSUjKr1u9EKv1AP0Ji2lD9zzLHf9u4Sb4oZkapi26RVgCKpQf9+
u+URTmSe0sjqD676Mvv9bnpVdJZkQp4QCXpdcU5zZEmFu6paAa9r0kAWRU9cVa1BBy9NrOX8/M4W
5HrxHPaXl2FXSkZ0ukpw3ZMaMZJJlhv8xM3edlKwZULjW3CXdgB8C8EbS9LsQCeqHFa93vpE3wtJ
SB8fxZQRadCfjJY/bGA9epj9Cn346XtKjOTCt0xY8en3qBei1aBrj7nGVH/JSPt/TbYHTp8qqpgm
2i3qavZB4IdN9wDpqBX51Ea1Jqd9/990bG2SrL17TgxVyCexSgeZooa3Eeow1duzdx1uOQXLnnOB
dhgE5+5zkR9WKDOBLgMltEhAUGyMT0VGB/9Jgo9hIoVA91UNsY2zVHR1F8Kj9Pj0B55ofIzuFq2z
2uW2a3M3ZYOuKWPdjYqwlDYXX0PHPUUNARHe3NoE+/Ps27rXfN8TrlLwEr2qQoXBJbVwZa9BsGOD
PtZOkah1rHfWifiHz5cD78+W0yrT9fP7+tWz/3Kv//8FUEsHCFKDhU4wBAAAYQ0AAFBLAQIUABQA
CAAIAJNtI0xSg4VOMAQAAGENAAAOAAAAAAAAAAAAAAAAAAAAAABKYXZhQWdlbnQuamF2YVBLBQYA
AAAAAQABADwAAABsBAAAAAA=
</filedata></file></object></item>
<item name='$FILE' summary='true' sign='true' seal='true'><object><file hosttype='msdos'
 compression='none' flags='sign' encoding='none' name='%%object%%.jar' size='1617'>
<created><datetime dst='true'>20170921T142849,22+02</datetime></created>
<modified><datetime>20180103T134442,50+01</datetime></modified><filedata>
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
SwUGAAAAAAEAAQA9AAAA/gUAAAAA
</filedata></file></object></item>
<item name='$JavaCompilerSource'><text>1.3</text></item>
<item name='$JavaCompilerTarget'><text>1.2</text></item>
<item name='$AssistVersion'><datetime>20180103T134442,69+01</datetime></item>
<item name='$TITLE' sign='true'><text>ImportAllVerseUsers</text></item>
<item name='$AssistType' sign='true'><number>65427</number></item>
<item name='$AssistLastRun' sign='true'>
<rawitemdata type='400'>
AAAAAAAAAAA=
</rawitemdata></item>
<item name='$AssistDocCount' sign='true'><number>0</number></item>
<item name='$FlagsExt' sign='true'><text/></item>
<item name='$AssistFlags' sign='true'><text>Es</text></item>
<item name='$AssistTrigger'><text>4</text></item>
<item name='$AssistInfo' sign='true'>
<rawitemdata type='11'>
AQAEAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</rawitemdata></item>
<item name='$AssistQuery' sign='true'>
<rawitemdata type='f'>
gQYAAAAA
</rawitemdata></item>
<item name='$AssistAction' sign='true'>
<rawitemdata type='10'>
gQKT/04ADwANAB8AAQAAAAAAAABKYXZhQWdlbnQuY2xhc3NjOlxOb3Rlc1xEYXRhJSVzb3VyY2Ul
JS5qYXIAJSVvYmplY3QlJS5qYXIAAAA=
</rawitemdata></item>
<item name='$AssistAction_Ex' sign='true'>
<rawitemdata type='14'>
gQI=
</rawitemdata></item>
<item name='$Restricted' sign='true'><number>0</number></item>
<item name='$Flags'><text>fJj3</text></item>
<item name='$DesignerVersion'><text>8.5.3</text></item>
<item name='$AssistRunInfo' summary='true'>
<rawitemdata type='3'>
BgAAAgAACADiAwAAAAAAAAUAAAAwAAAAAAAAAAAAAAAAAAAAngAAAAAAAAAAAAAAAAAAABAAAAAA
AAAASWZEAAuCJcEAAAAAbP9FAAqCJcG9NiwAoIElwQAAAAAAAAAAAAAAAAAAAAAAAAAAU3RhcnRl
ZCBydW5uaW5nIGFnZW50ICdJbXBvcnRBbGxWZXJzZVVzZXJzJyBvbiAyMDE4LTAxLTA0IDEzOjAy
OjIxDQpSYW4gSmF2YSBBZ2VudCBDbGFzcw0KRG9uZSBydW5uaW5nIGFnZW50ICdJbXBvcnRBbGxW
ZXJzZVVzZXJzJyBvbiAyMDE4LTAxLTA0IDEzOjI3OjA2DQoADQrJrFEv2OHJ9w4hRgAKgiXBqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
qqqqqqqqqqqqqqqqqqqqqqqq
</rawitemdata></item></note>
>>>>>>> 6484f1daf58b719c0503e1f0661e915e98e1b8ec

